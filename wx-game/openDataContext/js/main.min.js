var egret=window.egret,__reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);i.prototype=t.prototype,e.prototype=new i},Main=function(e){function t(){var t=e.call(this)||this;return wx.onMessage(function(e){e.isDisplay&&(e.isFriend?wx.getFriendCloudStorage({keyList:["score"],success:function(e){var i=e.data;for(var a in i)i[a].score=i[a].KVDataList[0].value;i.sort(t.compare("score")),t.runGame(i)},fail:function(e){console.log(e)},complete:function(){}}):e.isGroupRank&&wx.getGroupCloudStorage({shareTicket:e.shareInfo.shareTicket,keyList:["score"],success:function(e){var i=e.data;for(var a in i)i[a].score=i[a].KVDataList[0].value;i.sort(t.compare("score")),t.runGame(i)},fail:function(e){console.log(e)},complete:function(){}}))}),t}return __extends(t,e),t.prototype.compare=function(e){return function(t,i){var a=t[e],l=i[e];return l-a}},t.prototype.runGame=function(e){this.removeChild(this.myScroller),this.removeChild(this.labelNodata),this.myScroller=new eui.Scroller,this.myScroller.width=528,this.myScroller.height=500,this.myScroller.x=56,this.myScroller.y=50;var t=new eui.Rect;t.fillColor=16175463,t.width=528,t.height=500,t.x=56,t.y=50;var i=new eui.Group;if(0==e.length)return this.labelNodata=new eui.Label,this.labelNodata.x=56,this.labelNodata.y=50,this.labelNodata.width=528,this.labelNodata.height=500,this.labelNodata.fontFamily="PingFang-SC-Medium",this.labelNodata.size=32,this.labelNodata.textAlign="center",this.labelNodata.verticalAlign="middle",this.labelNodata.textColor=10066329,this.labelNodata.text="暂无人挑战，等你上榜~",void this.addChild(this.labelNodata);e.forEach(function(e,t){switch(t%2==0?e.isEven=0:e.isEven=1,e.index=parseInt(t)+1,e.index){case 1:e.honor="1",e.honorBg="0xDF6240",e.honortxtColor="0xffffff";break;case 2:e.honor=1,e.honorBg=15306331,e.honortxtColor=16777215;break;case 3:e.honor=1,e.honorBg=15640159,e.honortxtColor=16777215;break;default:e.honor="false",e.honortxtColor="0x999999"}});var a=new eui.List;a.dataProvider=new eui.ArrayCollection(e),a.itemRenderer=listRender,i.addChild(a),this.myScroller.viewport=i,this.addChild(t),this.addChild(this.myScroller)},t.prototype.cancelGame=function(){for(var e=0,t=this.numChildren;t>e;e++)this.removeChildAt(0)},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var listRender=function(e){function t(){var t=e.call(this)||this;return t.createRank(),t}return __extends(t,e),t.prototype.createRank=function(){this.rectBg=new eui.Rect,this.rectBg.x=0,this.rectBg.y=0,this.rectBg.width=528,this.rectBg.height=100,this.rectBg.fillColor=16768660,this.addChild(this.rectBg),this.rectHonour=new eui.Rect,this.rectHonour.x=30,this.rectHonour.y=32,this.rectHonour.width=42,this.rectHonour.height=42,this.rectHonour.ellipseWidth=42,this.rectHonour.ellipseHeight=42,this.addChild(this.rectHonour),this.labelIndex=new eui.Label,this.labelIndex.x=30,this.labelIndex.y=32,this.labelIndex.width=42,this.labelIndex.height=42,this.labelIndex.fontFamily="PingFang-SC-Medium",this.labelIndex.size=24,this.labelIndex.textAlign="center",this.labelIndex.verticalAlign="middle",this.addChild(this.labelIndex),this.labelName=new eui.Label,this.labelName.x=200,this.labelName.y=40,this.labelName.fontFamily="PingFang-SC-Medium",this.labelName.size=24,this.labelName.textAlign="center",this.labelIndex.verticalAlign="middle",this.labelName.textColor=3355443,this.addChild(this.labelName),this.labelScore=new eui.Label,this.labelScore.x=405,this.labelScore.y=40,this.labelScore.width=100,this.labelScore.fontFamily="PingFang-SC-Medium",this.labelScore.size=24,this.labelScore.textAlign="center",this.labelIndex.verticalAlign="middle",this.labelScore.textColor=3355443,this.addChild(this.labelScore)},t.prototype.dataChanged=function(){var e=this;switch(this.data.index){case 1:this.rectHonour.fillColor=14639680,this.labelIndex.textColor=16777215;break;case 2:this.rectHonour.fillColor=15306331,this.labelIndex.textColor=16777215;break;case 3:this.rectHonour.fillColor=15640159,this.labelIndex.textColor=16777215;break;default:this.rectHonour.alpha=0,this.labelIndex.textColor=10066329}this.labelIndex.text=this.data.index,this.labelName.text=this.data.nickname,this.labelScore.text=this.data.score,this.rectBg.alpha=this.data.isEven;var t=new egret.ImageLoader;t.addEventListener(egret.Event.COMPLETE,function(t){var i=t.currentTarget,a=new egret.Texture;a._setBitmapData(i.data),e.bitmapAvatar=new egret.Bitmap(a),e.bitmapAvatar.x=100,e.bitmapAvatar.y=28,e.bitmapAvatar.width=50,e.bitmapAvatar.height=50,e.addChild(e.bitmapAvatar)},this),t.load(this.data.avatarUrl)},t}(eui.ItemRenderer);__reflect(listRender.prototype,"listRender"),window.Main=Main;